# Writeup

## Solution

This is a bit similar to the previous question, except that `p` and `q` are 512 bits and this time we are given `n`. We will still use the same method to first get some modulo equations, then try to factor `n` using them.

Recap: We assume that the candidate `vm := v0 + 2m` is prime, i.e. `p = vm`. If for `vj = v0 + 2j` signal 0 is received after the trial division by `ri` then `vj` is divisible by `ri`. This gives `p = vj + 2(m − j) ≡ 2(m − j) (mod ri)`. 

Write a Python script to first extract csv data and get the modulos. Check `solve.py` for more info. In the end, we got:

```py
s = 12795439914148852838741934930166946004550443890117825618841082548932216698187933930048353898918710778190
cp = 2156314969454841303733895881839503766284681978601409100740177732311395884426234552903888117710961412917
cq = 10413134361950352807475064367290877020508157763155745135278207553091110121135422061445097328049712323927
p % s = cp
q % s = cq
```

Use Sage small_root to solve for `p` and `q`:

```py
N = 130242563655857624894400945577596726349342500250110028576899185041437457270571385988775800707021082684571500938230335838572343683077030043170929464612371476956037213483889197399888953059037490955052374761877827022364642118001281744384383425614733953384975007872647643383223846078326219496054222658506664194809

R.<x> = PolynomialRing(Zmod(N))
f = s * x + cp
f = f.monic()
print(f.small_roots(beta=0.5, epsilon=1/12))
# 937955046645898069484185386867672193679417243238240

p = 937955046645898069484185386867672193679417243238240 * s + cp
assert N % p == 0
q = N // p
```

This gives us


```py
p = 12001547441530273253959057011636545380682276982309094881808249299733218708057374770834552395747634676861756226375885883576968909405777765468745696927398517 
q = 10852147549337260608423075949090289487986778989707823131587822852017534934989234126291382575983230158893873931842292888007177685259095484544483805601177077

e = 65537
ct = 105907761990378066226415220707780642346253492128869807523331608442629667283774856771483475721417798409391047173653877895381454531056957845466445503946203117753779878926970882151071816334395199925843076844258607834225532144320120475312185170491128333893223806872578843356036259570319998389877610989110147615590

phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
pt = pow(ct, d, N)
print(long_to_bytes(int(pt)).decode()) # jU57_4_s1MpL3_s1d3_ch4nn3L_ch1p@_@
```